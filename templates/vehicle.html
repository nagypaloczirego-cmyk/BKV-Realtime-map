<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Jármű részletei</title>
<style>
body { font-family: Arial; padding: 15px; }
.status {
  font-size: 26px;
  font-weight: bold;
  margin: 15px 0;
}
.status.late { color: red; }
.status.early { color: green; }
.status.ontime { color: gray; }
li { margin: 4px 0; }
</style>
</head>
<body>

<h2>Jármű részletei</h2>

<div id="header">Betöltés…</div>
<div id="status"></div>
<ul id="stops"></ul>

<script>
const vehicleId = "{{ vehicle_id }}";

async function load(){
  const vehicles = await (await fetch("/api/vehicles")).json();
  const v = vehicles.find(x => x.vehicle_id === vehicleId);
  const trip = await (await fetch(`/trip/${v.trip_id}`)).json();

  document.getElementById("header").innerHTML = `
    <b>Rendszám:</b> ${v.license_plate}<br>
    <b>Vonal:</b> ${v.route_id}
  `;

  const status = document.getElementById("status");
  status.className = `status ${trip.delay_type}`;
  status.textContent = trip.delay_type === "ontime"
    ? "Állapot: időben"
    : `Állapot: ${trip.delay_txt}`;

  const ul = document.getElementById("stops");
  ul.innerHTML = "";
  trip.stops.forEach(s => {
    ul.innerHTML += `<li>${s.stop_name} (${s.time})</li>`;
  });
}

load();
</script>

</body>
</html>
